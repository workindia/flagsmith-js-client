!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var r in n)("object"==typeof exports?exports:t)[r]=n[r]}}(this,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,i=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&u.return&&u.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=n(3),a=(r=o)&&r.__esModule?r:{default:r};var u={getItem:function(t,e){return u.multiGet([t]).then((function(t){return t[0][1]})).then((function(t){return e&&e(null,t),t})).catch((function(t){return e&&e(t,null),t}))},setItem:function(t,e,n){return u.multiSet([[t,e]]).then((function(t){return n&&n(null,t),t})).catch((function(t){return n&&n(t,null),t}))},getAllKeys:function(t){return Promise.resolve(Object.keys(localStorage)).then((function(e){return t&&t(null,e),e})).catch((function(e){return t&&t(e,null),e}))},removeItem:function(t,e){return u.multiRemove([t]).then((function(){e&&e(null)})).catch((function(t){e&&e(t,null)}))},clear:function(){return new Promise((function(t){window.localStorage.clear(),t()}))},mergeItem:function(t,e){return u.multiMerge([[t,e]])},multiGet:function(t){return new Promise((function(e){e(t.reduce((function(t,e){return t.concat([[e,localStorage.getItem(e)]])}),[]))}))},multiSet:function(t){return new Promise((function(e,n){var r=[];return t.forEach((function(t){var e=i(t,2),n=e[0],o=e[1];try{localStorage.setItem(n,o)}catch(t){r.push(t)}})),r.length>0?n(r):e()}))},multiMerge:function(t){return new Promise((function(e,n){var r=[];return t.forEach((function(t){var e=i(t,2),n=e[0],o=e[1],u=localStorage.getItem(n);if(u)try{localStorage.setItem(n,JSON.stringify((0,a.default)(JSON.parse(u),JSON.parse(o))))}catch(t){r.push(t)}})),r.length>0?n(r):e()}))},multiRemove:function(t){return new Promise((function(e){t.forEach((function(t){return window.localStorage.removeItem(t)})),e()}))},flushGetRequests:function(){console.warn("AsyncStorage.flushGetRequests: Not supported on `web`")}};e.default=u},function(t,e,n){"use strict";n.r(e),n.d(e,"createFlagsmithInstance",(function(){return s}));var r=n(0),i=n.n(r),o=n(2).default,a=n(5),u=a({AsyncStorage:i.a,fetch:o});"undefined"!=typeof window&&(window.flagsmith=u),e.default=u;var s=function(){return a({AsyncStorage:i.a,fetch:o})}},function(t,e,n){"use strict";n.r(e),e.default=function(t,e){return e=e||{},new Promise((function(n,r){var i=new XMLHttpRequest,o=[],a=[],u={},s=function(){return{ok:2==(i.status/100|0),statusText:i.statusText,status:i.status,url:i.responseURL,text:function(){return Promise.resolve(i.responseText)},json:function(){return Promise.resolve(JSON.parse(i.responseText))},blob:function(){return Promise.resolve(new Blob([i.response]))},clone:s,headers:{keys:function(){return o},entries:function(){return a},get:function(t){return u[t.toLowerCase()]},has:function(t){return t.toLowerCase()in u}}}};for(var c in i.open(e.method||"get",t,!0),i.onload=function(){i.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,(function(t,e,n){o.push(e=e.toLowerCase()),a.push([e,n]),u[e]=u[e]?u[e]+","+n:n})),n(s())},i.onerror=r,i.withCredentials="include"==e.credentials,e.headers)i.setRequestHeader(c,e.headers[c]);i.send(e.body||null)}))}},function(t,e,n){(function(t){var n=200,r="__lodash_hash_undefined__",i=800,o=16,a=9007199254740991,u="[object Arguments]",s="[object AsyncFunction]",c="[object Function]",l="[object GeneratorFunction]",f="[object Null]",h="[object Object]",v="[object Proxy]",g="[object Undefined]",p=/^\[object .+?Constructor\]$/,y=/^(?:0|[1-9]\d*)$/,d={};d["[object Float32Array]"]=d["[object Float64Array]"]=d["[object Int8Array]"]=d["[object Int16Array]"]=d["[object Int32Array]"]=d["[object Uint8Array]"]=d["[object Uint8ClampedArray]"]=d["[object Uint16Array]"]=d["[object Uint32Array]"]=!0,d[u]=d["[object Array]"]=d["[object ArrayBuffer]"]=d["[object Boolean]"]=d["[object DataView]"]=d["[object Date]"]=d["[object Error]"]=d[c]=d["[object Map]"]=d["[object Number]"]=d[h]=d["[object RegExp]"]=d["[object Set]"]=d["[object String]"]=d["[object WeakMap]"]=!1;var b="object"==typeof global&&global&&global.Object===Object&&global,m="object"==typeof self&&self&&self.Object===Object&&self,_=b||m||Function("return this")(),O=e&&!e.nodeType&&e,j=O&&"object"==typeof t&&t&&!t.nodeType&&t,S=j&&j.exports===O,w=S&&b.process,E=function(){try{var t=j&&j.require&&j.require("util").types;return t||w&&w.binding&&w.binding("util")}catch(t){}}(),I=E&&E.isTypedArray;function P(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}var A,F,T,k=Array.prototype,N=Function.prototype,x=Object.prototype,L=_["__core-js_shared__"],C=N.toString,J=x.hasOwnProperty,D=(A=/[^.]+$/.exec(L&&L.keys&&L.keys.IE_PROTO||""))?"Symbol(src)_1."+A:"",z=x.toString,R=C.call(Object),U=RegExp("^"+C.call(J).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),M=S?_.Buffer:void 0,B=_.Symbol,G=_.Uint8Array,$=M?M.allocUnsafe:void 0,q=(F=Object.getPrototypeOf,T=Object,function(t){return F(T(t))}),V=Object.create,H=x.propertyIsEnumerable,K=k.splice,W=B?B.toStringTag:void 0,X=function(){try{var t=Ot(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),Q=M?M.isBuffer:void 0,Y=Math.max,Z=Date.now,tt=Ot(_,"Map"),et=Ot(Object,"create"),nt=function(){function t(){}return function(e){if(!xt(e))return{};if(V)return V(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();function rt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function it(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function ot(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function at(t){var e=this.__data__=new it(t);this.size=e.size}function ut(t,e){var n=At(t),r=!n&&Pt(t),i=!n&&!r&&Tt(t),o=!n&&!r&&!i&&Ct(t),a=n||r||i||o,u=a?function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}(t.length,String):[],s=u.length;for(var c in t)!e&&!J.call(t,c)||a&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||jt(c,s))||u.push(c);return u}function st(t,e,n){(void 0===n||It(t[e],n))&&(void 0!==n||e in t)||ft(t,e,n)}function ct(t,e,n){var r=t[e];J.call(t,e)&&It(r,n)&&(void 0!==n||e in t)||ft(t,e,n)}function lt(t,e){for(var n=t.length;n--;)if(It(t[n][0],e))return n;return-1}function ft(t,e,n){"__proto__"==e&&X?X(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}rt.prototype.clear=function(){this.__data__=et?et(null):{},this.size=0},rt.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},rt.prototype.get=function(t){var e=this.__data__;if(et){var n=e[t];return n===r?void 0:n}return J.call(e,t)?e[t]:void 0},rt.prototype.has=function(t){var e=this.__data__;return et?void 0!==e[t]:J.call(e,t)},rt.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=et&&void 0===e?r:e,this},it.prototype.clear=function(){this.__data__=[],this.size=0},it.prototype.delete=function(t){var e=this.__data__,n=lt(e,t);return!(n<0)&&(n==e.length-1?e.pop():K.call(e,n,1),--this.size,!0)},it.prototype.get=function(t){var e=this.__data__,n=lt(e,t);return n<0?void 0:e[n][1]},it.prototype.has=function(t){return lt(this.__data__,t)>-1},it.prototype.set=function(t,e){var n=this.__data__,r=lt(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this},ot.prototype.clear=function(){this.size=0,this.__data__={hash:new rt,map:new(tt||it),string:new rt}},ot.prototype.delete=function(t){var e=_t(this,t).delete(t);return this.size-=e?1:0,e},ot.prototype.get=function(t){return _t(this,t).get(t)},ot.prototype.has=function(t){return _t(this,t).has(t)},ot.prototype.set=function(t,e){var n=_t(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this},at.prototype.clear=function(){this.__data__=new it,this.size=0},at.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},at.prototype.get=function(t){return this.__data__.get(t)},at.prototype.has=function(t){return this.__data__.has(t)},at.prototype.set=function(t,e){var r=this.__data__;if(r instanceof it){var i=r.__data__;if(!tt||i.length<n-1)return i.push([t,e]),this.size=++r.size,this;r=this.__data__=new ot(i)}return r.set(t,e),this.size=r.size,this};var ht,vt=function(t,e,n){for(var r=-1,i=Object(t),o=n(t),a=o.length;a--;){var u=o[ht?a:++r];if(!1===e(i[u],u,i))break}return t};function gt(t){return null==t?void 0===t?g:f:W&&W in Object(t)?function(t){var e=J.call(t,W),n=t[W];try{t[W]=void 0;var r=!0}catch(t){}var i=z.call(t);r&&(e?t[W]=n:delete t[W]);return i}(t):function(t){return z.call(t)}(t)}function pt(t){return Lt(t)&&gt(t)==u}function yt(t){return!(!xt(t)||function(t){return!!D&&D in t}(t))&&(kt(t)?U:p).test(function(t){if(null!=t){try{return C.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t))}function dt(t){if(!xt(t))return function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}(t);var e=St(t),n=[];for(var r in t)("constructor"!=r||!e&&J.call(t,r))&&n.push(r);return n}function bt(t,e,n,r,i){t!==e&&vt(e,(function(o,a){if(i||(i=new at),xt(o))!function(t,e,n,r,i,o,a){var u=wt(t,n),s=wt(e,n),c=a.get(s);if(c)return void st(t,n,c);var l=o?o(u,s,n+"",t,e,a):void 0,f=void 0===l;if(f){var v=At(s),g=!v&&Tt(s),p=!v&&!g&&Ct(s);l=s,v||g||p?At(u)?l=u:Lt(_=u)&&Ft(_)?l=function(t,e){var n=-1,r=t.length;e||(e=Array(r));for(;++n<r;)e[n]=t[n];return e}(u):g?(f=!1,l=function(t,e){if(e)return t.slice();var n=t.length,r=$?$(n):new t.constructor(n);return t.copy(r),r}(s,!0)):p?(f=!1,y=s,d=!0?(b=y.buffer,m=new b.constructor(b.byteLength),new G(m).set(new G(b)),m):y.buffer,l=new y.constructor(d,y.byteOffset,y.length)):l=[]:function(t){if(!Lt(t)||gt(t)!=h)return!1;var e=q(t);if(null===e)return!0;var n=J.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&C.call(n)==R}(s)||Pt(s)?(l=u,Pt(u)?l=function(t){return function(t,e,n,r){var i=!n;n||(n={});var o=-1,a=e.length;for(;++o<a;){var u=e[o],s=r?r(n[u],t[u],u,n,t):void 0;void 0===s&&(s=t[u]),i?ft(n,u,s):ct(n,u,s)}return n}(t,Jt(t))}(u):xt(u)&&!kt(u)||(l=function(t){return"function"!=typeof t.constructor||St(t)?{}:nt(q(t))}(s))):f=!1}var y,d,b,m;var _;f&&(a.set(s,l),i(l,s,r,o,a),a.delete(s));st(t,n,l)}(t,e,a,n,bt,r,i);else{var u=r?r(wt(t,a),o,a+"",t,e,i):void 0;void 0===u&&(u=o),st(t,a,u)}}),Jt)}function mt(t,e){return Et(function(t,e,n){return e=Y(void 0===e?t.length-1:e,0),function(){for(var r=arguments,i=-1,o=Y(r.length-e,0),a=Array(o);++i<o;)a[i]=r[e+i];i=-1;for(var u=Array(e+1);++i<e;)u[i]=r[i];return u[e]=n(a),P(t,this,u)}}(t,e,Rt),t+"")}function _t(t,e){var n,r,i=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof e?"string":"hash"]:i.map}function Ot(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return yt(n)?n:void 0}function jt(t,e){var n=typeof t;return!!(e=null==e?a:e)&&("number"==n||"symbol"!=n&&y.test(t))&&t>-1&&t%1==0&&t<e}function St(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||x)}function wt(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var Et=function(t){var e=0,n=0;return function(){var r=Z(),a=o-(r-n);if(n=r,a>0){if(++e>=i)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}(X?function(t,e){return X(t,"toString",{configurable:!0,enumerable:!1,value:(n=e,function(){return n}),writable:!0});var n}:Rt);function It(t,e){return t===e||t!=t&&e!=e}var Pt=pt(function(){return arguments}())?pt:function(t){return Lt(t)&&J.call(t,"callee")&&!H.call(t,"callee")},At=Array.isArray;function Ft(t){return null!=t&&Nt(t.length)&&!kt(t)}var Tt=Q||function(){return!1};function kt(t){if(!xt(t))return!1;var e=gt(t);return e==c||e==l||e==s||e==v}function Nt(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=a}function xt(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function Lt(t){return null!=t&&"object"==typeof t}var Ct=I?function(t){return function(e){return t(e)}}(I):function(t){return Lt(t)&&Nt(t.length)&&!!d[gt(t)]};function Jt(t){return Ft(t)?ut(t,!0):dt(t)}var Dt,zt=(Dt=function(t,e,n){bt(t,e,n)},mt((function(t,e){var n=-1,r=e.length,i=r>1?e[r-1]:void 0,o=r>2?e[2]:void 0;for(i=Dt.length>3&&"function"==typeof i?(r--,i):void 0,o&&function(t,e,n){if(!xt(n))return!1;var r=typeof e;return!!("number"==r?Ft(n)&&jt(e,n.length):"string"==r&&e in n)&&It(n[e],t)}(e[0],e[1],o)&&(i=r<3?void 0:i,r=1),t=Object(t);++n<r;){var a=e[n];a&&Dt(t,a,n,i)}return t})));function Rt(t){return t}t.exports=zt}).call(this,n(4)(t))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function o(t){for(var e,n=1;n<arguments.length;n++)e=null==arguments[n]?{}:arguments[n],n%2?i(e,!0).forEach((function(n){u(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):i(e).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}));return t}function a(t,e){for(var n,r=0;r<e.length;r++)(n=e[r]).enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var s,c,l="https://api.flagsmith.com/api/v1/",f=n(6),h=function(t){return"Attempted to "+t+" a user before calling flagsmith.init. Call flagsmith.init first, if you wish to prevent it sending a request for flags, call init with preventFetch:true."},v=function(){function t(e){var n=this;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),u(this,"getJSON",(function(t,e,r){var i=n.environmentID,o=n.headers,a={method:e||"GET",body:r,headers:{"x-environment-key":i}};return e&&"GET"!==e&&(a.headers["Content-Type"]="application/json; charset=utf-8"),o&&Object.assign(a.headers,o),s(t,a).then((function(t){return t.text().then((function(e){var n=e;try{n=JSON.parse(e)}catch(t){}return t.ok?n:Promise.reject(n)}))}))})),u(this,"getFlags",(function(t,e){var r=n.onChange,i=n.onError,a=n.identity,u=n.api,s=(n.disableCache,!1),c=function(t,e){var i=t.flags,a=t.traits;n.withTraits=!1;var u={},s={};if(a=a||[],(i=i||[]).forEach((function(t){u[t.feature.name.toLowerCase().replace(/ /g,"_")]={id:t.feature.id,enabled:t.enabled,value:t.feature_state_value}})),a.forEach((function(t){s[t.trait_key.toLowerCase().replace(/ /g,"_")]=t.trait_value})),n.oldFlags=o({},n.flags),e){var c={};e.map((function(t){c[t.name]=t})),n.segments=c}var l=f(n.flags,u),h=f(n.traits,s);n.flags=u,n.traits=s,n.updateStorage(),r&&r(n.oldFlags,{isFromServer:!0,flagsChanged:!l,traitsChanged:!h})};return a?Promise.all([n.withTraits?n.getJSON(u+"identities/","POST",JSON.stringify({identifier:a,traits:Object.keys(n.withTraits).map((function(t){return{trait_key:t,trait_value:n.withTraits[t]}}))})):n.getJSON(u+"identities/?identifier="+encodeURIComponent(a))]).then((function(t){c(t[0],t[1])})).catch((function(t){var e=t.message;i&&i({message:e})})):Promise.all([n.getJSON(u+"flags/")]).then((function(e){c({flags:e[0]},null),t&&!s&&(s=!0,t())})).catch((function(t){e&&!s&&(s=!0,e(t)),i&&i(t)}))})),u(this,"analyticsFlags",(function(){var t=n.api;if(0!==Object.getOwnPropertyNames(n.evaluationEvent).length)return n.getJSON(t+"analytics/flags/","POST",JSON.stringify(n.evaluationEvent)).then((function(){state=n.getState(),n.setState(o({},state,{evaluationEvent:{}})),n.updateEventStorage()})).catch((function(t){n.log("Exception fetching evaluationEvent",t)}))})),u(this,"evaluateFlag",(function(t){if(n.enableAnalytics){if(!n.evaluationEvent)return;void 0===n.evaluationEvent[t]&&(n.evaluationEvent[t]=0),n.evaluationEvent[t]+=1}n.updateEventStorage()})),u(this,"getValue",(function(t){var e=n.flags&&n.flags[t.toLowerCase().replace(/ /g,"_")],r=null;return e&&(r=e.value),n.evaluateFlag(t),r})),u(this,"getTrait",(function(t){return n.traits&&n.traits[t.toLowerCase().replace(/ /g,"_")]})),u(this,"setTrait",(function(t,e){var r=n.getJSON,i=n.identity,o=n.api;if(o)return r("".concat(o,"traits/"),"POST",JSON.stringify({identity:{identifier:i},trait_key:t,trait_value:e})).then((function(){n.initialised&&n.getFlags()}));console.error(h("setTrait"))})),u(this,"setTraits",(function(t){var e=n.getJSON,i=n.identity,o=n.api;if(o){t&&"object"===r(t)||console.error("Expected object for flagsmith.setTraits");var a=Object.keys(t).map((function(e){return{identity:{identifier:i},trait_key:e,trait_value:t[e]}}));return e("".concat(o,"traits/bulk/"),"PUT",JSON.stringify(a)).then((function(){n.initialised&&n.getFlags()}))}console.error(h("setTraits"))})),u(this,"incrementTrait",(function(t,e){var r=n.getJSON,i=n.identity,o=n.api;return r("".concat(o,"traits/increment-value/"),"POST",JSON.stringify({trait_key:t,increment_by:e,identifier:i})).then(n.getFlags)})),u(this,"hasFeature",(function(t){var e=n.flags&&n.flags[t.toLowerCase().replace(/ /g,"_")],r=!1;return e&&e.enabled&&(r=!0),n.evaluateFlag(t),r})),s=e.fetch?e.fetch:global.fetch,c=e.AsyncStorage}return function(t,e,n){e&&a(t.prototype,e),n&&a(t,n)}(t,[{key:"init",value:function(t){var e=this,n=t.environmentID,r=t.api,i=void 0===r?l:r,a=t.headers,u=t.onChange,s=t.cacheFlags,f=t.onError,h=t.defaultFlags,v=t.preventFetch,g=t.enableLogs,p=t.enableAnalytics,y=t.AsyncStorage,d=t.state;return new Promise((function(t,r){if(e.environmentID=n,e.api=i,e.headers=a,e.getFlagInterval=null,e.analyticsInterval=null,e.onChange=u,e.onError=f,e.enableLogs=g,e.enableAnalytics=!!p&&p,e.flags=Object.assign({},h)||{},e.initialised=!0,e.ticks=1e4,e.timer=e.enableLogs?(new Date).valueOf():null,y&&(c=y),e.cacheFlags=void 0!==c&&s,e.setState(d),!n)throw r("Please specify a environment id"),"Please specify a environment id";c.getItem("BULLET_TRAIN_EVENT").then((function(t){if(t)try{e.evaluationEvent=JSON.parse(t)}catch(t){e.evaluationEvent={}}else e.evaluationEvent={};e.analyticsInterval=setInterval(e.analyticsFlags,e.ticks)})),e.enableAnalytics&&(e.analyticsInterval&&clearInterval(e.analyticsInterval),c.getItem("BULLET_TRAIN_EVENT",(function(t,n){if(n){var r=JSON.parse(n);r&&(d=e.getState(),e.log("Retrieved events from cache",n),e.setState(o({},d,{evaluationEvent:r})))}}))),s?c.getItem("BULLET_TRAIN_DB",(function(n,i){if(i)try{var o=JSON.parse(i);o&&o.api===e.api&&o.environmentID===e.environmentID&&(e.setState(o),e.log("Retrieved flags from cache",o)),e.flags?(e.onChange&&e.onChange(null,{isFromServer:!1}),e.oldFlags=e.flags,t(),!v&&e.getFlags(Promise.resolve,Promise.reject)):v?t():e.getFlags(t,r)}catch(t){e.log("Exception fetching cached logs",t)}else v?(h&&e.onChange(null,{isFromServer:!1}),t()):e.getFlags(t,r)})):v?(h&&e.onChange(null,{isFromServer:!1}),t()):e.getFlags(t,r)})).catch((function(t){return f(t)}))}},{key:"getAllFlags",value:function(){return this.flags}},{key:"identify",value:function(t,e){return this.identity=t,e&&(this.withTraits=e),this.initialised&&!this.getFlagInterval?this.getFlags():Promise.resolve()}},{key:"getState",value:function(){return{api:this.api,environmentID:this.environmentID,flags:this.flags,identity:this.identity,segments:this.segments,traits:this.traits,evaluationEvent:this.evaluationEvent}}},{key:"setState",value:function(t){t&&(this.initialised=!0,this.api=t.api||this.api||l,this.environmentID=t.environmentID||this.environmentID,this.flags=t.flags||this.flags,this.identity=t.identity||this.identity,this.segments=t.segments||this.segments,this.traits=t.traits||this.traits,this.evaluationEvent=t.evaluationEvent||this.evaluationEvent)}},{key:"log",value:function(){if(this.enableLogs){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];console.log.apply(this,["FLAGSMITH:",(new Date).valueOf()-this.timer,"ms"].concat(e))}}},{key:"updateStorage",value:function(){if(this.cacheFlags){var t=JSON.stringify(this.getState());this.log("Setting storage",t),c.setItem("BULLET_TRAIN_DB",t)}}},{key:"updateEventStorage",value:function(){if(this.enableAnalytics){var t=JSON.stringify(this.getState().evaluationEvent);this.log("Setting event storage",t),c.setItem("BULLET_TRAIN_EVENT",t)}}},{key:"logout",value:function(){return this.identity=null,this.segments=null,this.traits=null,this.initialised&&!this.getFlagInterval?this.getFlags():Promise.resolve()}},{key:"startListening",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1e3;this.getFlagInterval&&clearInterval(this.getFlagInterval),this.getFlagInterval=setInterval(this.getFlags,t)}},{key:"stopListening",value:function(){clearInterval(this.getFlagInterval),this.getFlagInterval=null}},{key:"getSegments",value:function(){}}]),t}();t.exports=function(t){var e=t.fetch,n=t.AsyncStorage;return new v({fetch:e,AsyncStorage:n})}},function(t,e,n){"use strict";t.exports=function t(e,n){if(e===n)return!0;if(e&&n&&"object"==typeof e&&"object"==typeof n){if(e.constructor!==n.constructor)return!1;var r,i,o;if(Array.isArray(e)){if((r=e.length)!=n.length)return!1;for(i=r;0!=i--;)if(!t(e[i],n[i]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if((r=(o=Object.keys(e)).length)!==Object.keys(n).length)return!1;for(i=r;0!=i--;)if(!Object.prototype.hasOwnProperty.call(n,o[i]))return!1;for(i=r;0!=i--;){var a=o[i];if(!t(e[a],n[a]))return!1}return!0}return e!=e&&n!=n}}])}));